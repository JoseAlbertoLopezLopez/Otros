% !TEX encoding = UTF-8 Unicode
\documentclass[12pt, letterpaper, oneside]{report}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}


% Rutas a utilizar
\makeatletter
\def\input@path{
	{./img/plots/}
	{./def/}
	{./redef/}
	{./img/solids/src/definitions/}
	{./img/solids/src/settings/}
}
\makeatother


% Configuraciones generales
\usepackage{geometry}
\geometry{
	%right = 0mm,
	%left = 0mm,
	%top = 20mm,
	bottom = 33mm
}

\usepackage{xcolor}
\input{maincolors.tex}
\pagecolor{pagecolor}


% Varios
\usepackage[spanish]{babel}
\spanishdecimal{.}

\usepackage{anyfontsize}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{calligra}
\usepackage{ragged2e}
\usepackage{calc}
\usepackage[group-separator = {,}, group-minimum-digits = 4]{siunitx}
\usepackage{bm}
\usepackage[normalem]{ulem}
\usepackage{printlen}
\usepackage{tcolorbox}
\usepackage{fontawesome5}
\usepackage{adjustbox}
\usepackage{etoolbox}


% Texto
\setlength{\parskip}{0.5pt}
\makeatletter
\color{maintextcolor}
\global\let\default@color\current@color
\makeatother


% Espaciado de entornos
\newlength{\environmentstextsep}
\setlength{\environmentstextsep}{1.1\intextsep}
\setlength{\intextsep}{\environmentstextsep}
\setlength{\topsep}{1.1\intextsep}

\AfterEndEnvironment{figure}{\vspace{-\parskip}\ignorespacesafterend\nointerlineskip\noindent}
\AfterEndEnvironment{table}{\vspace{-\parskip}\ignorespacesafterend\nointerlineskip\noindent}

\BeforeBeginEnvironment{center}{\vspace{-\parskip}}
\AtBeginEnvironment{center}{\setlength{\lineskip}{0pt}}
\AfterEndEnvironment{center}{\vspace{-\parskip}\ignorespacesafterend\nointerlineskip\noindent}


% Imágenes
\graphicspath{
	{./img/}
	{./img/cover/}
	{./img/plots/}
	{./img/related_work/}
	{./img/solids/}
}

\usepackage[
	labelfont = bf, 
	aboveskip = 0.9\baselineskip, 
	strut = off
]{caption}

\usepackage{subcaption}
\DeclareCaptionLabelFormat{rparen}{\textit{#2)}}
\captionsetup[sub]{
	labelfont = it,
	aboveskip = 3.5pt,
	belowskip = 0pt,
    labelformat = rparen,
    subrefformat = rparen,
    strut = off
}

\renewcommand\thesubfigure{\alph{subfigure}}
\DeclareCaptionFormat{algocaption}{#1}
\usepackage{epsfig}

% Centrar imágenes horizontalmente por defecto.
\makeatletter
\g@addto@macro\@floatboxreset\centering
\makeatother


% Matemáticas
\usepackage{stmaryrd}
\usepackage{mathtools}

% Símbolo de celda vacía.
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}
\let\oldboxslash\boxslash%
\renewcommand{\boxslash}{\raisebox{0.5pt}{$\oldboxslash$}}

\newlength{\shortequationtopvsep}
\newlength{\shortequationbottomvsep}
\newlength{\equationtopvsep}
\newlength{\equationbottomvsep}

\AtBeginDocument{%
\setlength{\shortequationtopvsep}{1.1\abovedisplayskip}
\setlength{\shortequationbottomvsep}{1.1\abovedisplayskip}
\setlength{\equationtopvsep}{1.1\abovedisplayskip}
\setlength{\equationbottomvsep}{1.1\belowdisplayskip}
\setlength{\abovedisplayshortskip}{\shortequationtopvsep}
\setlength{\belowdisplayshortskip}{\shortequationbottomvsep}
\setlength{\abovedisplayskip}{\equationtopvsep}
\setlength{\belowdisplayskip}{\equationbottomvsep}
}


% Listas y descripciones
\usepackage{enumitem}
\renewcommand{\labelitemi}{\raisebox{0.1\baselineskip}{\fontsize{5}{5}\selectfont$\blacksquare$}}

\setlist[itemize]{
	leftmargin = \parindent, 
	topsep = \environmentstextsep - \parskip
}
\setlist[enumerate]{
	leftmargin = \parindent + 0.5\labelsep, 
	topsep = \environmentstextsep - \parskip
}

\newlist{descriptionParams}{description}{3}
\setlist[descriptionParams]{
	style = nextline,
	leftmargin = 0.285\textwidth, 
	align = right,
	topsep = \baselineskip,
	itemsep = 0pt
}


% Tabla de contenidos
\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\normalfont\fontsize{28}{28}\bfseries}
\setlength{\cftaftertoctitleskip}{43.3pt}
\setlength{\cftbeforetoctitleskip}{52.5pt}
\setlength{\cftbeforesecskip}{1pt}
\setlength{\cftbeforesubsecskip}{1pt}
\makeatletter
\renewcommand{\@tocrmarg}{1em}
\renewcommand{\@pnumwidth}{1em}
\renewcommand{\cftdotsep}{5.5}
\makeatother


% Títulos de secciones
\AtBeginDocument{\renewcommand{\contentsname}{Contenido}}

\usepackage{titlesec}
\titleformat{\chapter}[display]{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{40pt - \parskip}{\fontsize{28}{28}\selectfont}
\titleformat{\section}{\normalfont\Large\bfseries}{}{0em}{\thesection\ \ }
\titleformat{\subsection}{\normalfont\large\bfseries}{}{0em}{\thesubsection\ \ }

\titlespacing*{\chapter}{0pt}{50pt - \parskip}{40pt - \parskip}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex - \parskip}{2.3ex plus .2ex - \parskip}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex - \parskip}{1.5ex plus .2ex - \parskip}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex - \parskip}{1.5ex plus .2ex - \parskip}

% No indentar después de un título.
\makeatletter
\def\@afterindentfalse{\let\if@afterindent\iffalse}
\makeatother


% Gráficos
\usepackage{pst-solides3d}

\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{
	babel, 
	calc, 
	graphs, 
	positioning, 
	quotes, 
	shadows
}

\input{solids_definitions.tex}


% Tablas
\usepackage{booktabs}
\usepackage{colortbl}

\captionsetup[table]{name = Tabla}

% Caption arriba de la tabla.
\floatstyle{plaintop}
\restylefloat{table}
\newcommand{\savetablewidth}[1]{%
	\newdimen\tablewidth%
	\settowidth{\tablewidth}{#1}%
		#1%
}
\newcommand{\saveminipagetablewidth}[1]{%
	\newdimen\tablewidth%
	\settowidth{\tablewidth}{#1}%
	\begin{minipage}{\tablewidth}%
		#1%
	\end{minipage}%
}

\newlength{\tablecaptionskip}
\setlength{\tablecaptionskip}{0.6\baselineskip}

\makeatletter
\def\fs@plaintop{%
	\fs@plain%
	\def\@fs@mid{\vspace{\tablecaptionskip}\relax}%
	\let\@fs@iftopcapt\iftrue%
}
\makeatother


% Algoritmos
\usepackage[
	linesnumbered, 
	procnumbered, 
	ruled, 
	lined
]{algorithm2e}

\input{algorithm2e_redefs.tex}

\SetAlgoFuncName{Función}{}
\SetAlgorithmName{Algoritmo}{}

\SetKwInput{Data}{Datos}
\SetKwInput{Result}{Resultado}
\SetKwInput{Definitions}{Definiciones}
\SetKwProg{Function}{function}{:}{end}

% Formato para nombres de funciones.
\def\f#1{\textsl{#1}}

\SetKw{Not}{not}
\SetKw{Or}{or}
\SetKwIF
	{IfWithNoThen}
	{ElseIfWithNoThen}
	{Else}
	{if}
	{}
	{else if}
	{else}
	{end}

% Redefinición de símbolo de comentario y su estilo.
\def\speechBubbleComment{\fontsize{10}{10}\selectfont\faComments[regular]}
\SetKwComment{tcp}{\speechBubbleComment\ }{}
\newcommand\commentstyle[1]{\ttfamily\textcolor{gray!80!black}{\textit{#1}}}
\SetCommentSty{commentstyle}
% Indentación de líneas subsecuentes de comentarios.
\newlength{\CommentHangIndent}
\newcommand{\SetAlgoCommentHangIndent}[1]{\setlength{\CommentHangIndent}{#1}}
\SetAlgoCommentHangIndent{\widthof{\CommentSty{\speechBubbleComment\ }}}

% Indentación de líneas subsecuentes de párrafos.
\SetAlgoHangIndent{0em}

\makeatletter
\newcounter{function}
\AtBeginEnvironment{function}{\let\c@algocf\c@function}

% Hacer que al hacer clic sobre una referencia a un algoritmo, mande a la parte superior del caption en el PDF.
\long\def\algocf@caption@algo#1[#2]#3{%
	\algocf@latexcaption{#1}[#2]{#3}%
}
\makeatother

\setlength{\interspacetitleruled}{4pt}
\IncMargin{0.3ex}
\SetInd{0.25em}{1em}
\gdef\algoskip{\vspace{0pt}}
\SetAlgoSkip{algoskip}
\gdef\algoinsideskip{\HalfBlankLine}
\SetAlgoInsideSkip{algoinsideskip}
\DontPrintSemicolon

\newcommand{\QuarterBlankLine}{\vskip 0.25ex}
\newcommand{\HalfBlankLine}{\vskip 0.5ex}
\newcommand{\HalfQuarterBlankLine}{\vskip 0.75ex}
\newcommand{\OneQuarterBlankLine}{\BlankLine\vskip 0.25ex}
\newcommand{\OneHalfBlankLine}{\BlankLine\vskip 0.5ex}
\newcommand{\TwoBlankLines}{\BlankLine\BlankLine}

\newlength{\rightalgomargin}
\setlength{\rightalgomargin}{\algomargin}
\newlength{\originalparindent}
\setlength{\originalparindent}{\parindent}
\addtolength{\rightalgomargin}{\originalparindent}
\newlist{definitions}{description}{1}
\setlist[definitions]{
	labelindent = \originalparindent,
	leftmargin = \originalparindent,
	rightmargin = \rightalgomargin,
	topsep = 0pt,
	itemsep = 0pt,
	parsep = 0pt
}


% Encabezado
\usepackage{fancyhdr}

% Personalizar encabezado.
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter . \textit{#1}}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}

\fancypagestyle{main}{%
	\fancyhf{}%
	\setlength{\headwidth}{\textwidth}%
	\setlength{\headheight}{15pt}%
	\fancyhead[L]{\leftmark}%
	\fancyhead[R]{\rightmark}%
	\renewcommand{\headrulewidth}{0.5pt}%
	\fancyfoot[C]{\thepage}%
}


% Notas al pie
\usepackage[symbol, hang, bottom]{footmisc}
\input{footmisc_redefs.tex}
\renewcommand{\thempfootnote}{\fnsymbol{mpfootnote}}
\setlength{\footnotemargin}{0.7em}


% Hipervínculos.
\usepackage{hyperref}
\usepackage{url}
\hypersetup{hidelinks, linktoc = all, colorlinks=true, allcolors = maintextcolor, urlcolor = blue!80}



%================================================================================================================================
\begin{document}
%================================================================================================================================
%
%
%
\include{./src/Portada}
\pagestyle{main}%
%
\pagenumbering{roman}%
%
\include{./src/Dedicatoria}
%\null\clearpage%
%\include{./src/Agradecimientos}
\tableofcontents%
\thispagestyle{plain}%
\cleardoublepage%
%
\pagenumbering{arabic}%
\setcounter{page}{1}%
%
\include{./src/Introduccion}
\include{./src/Trabajos_relacionados}
\include{./src/Marco_teorico}
\include{./src/Metodologia_propuesta}
\include{./src/Resultados}
\include{./src/Conclusiones}
%
\fancyhead[L]{\textit{Referencias}}%
\fancyhead[R]{}%
\renewcommand\bibname{Referencias}%
\addcontentsline{toc}{chapter}{Referencias}%
\bibliographystyle{unsrt}%
\bibliography{./src/Bibliografia}
%
%
%
%================================================================================================================================
\end{document}
%================================================================================================================================